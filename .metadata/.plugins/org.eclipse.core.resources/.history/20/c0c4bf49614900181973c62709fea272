package uebung03_02;

import java.util.List;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.net.Socket;
import java.nio.file.Files;
import java.nio.file.Paths;

public class Sockets implements Runnable {

	private Socket clientConnection;
	private List<String> lines;

	public Sockets(Socket clientConnection) {
		this.clientConnection = clientConnection;
	}

	@Override
	public void run() {
		System.out.println("Thread gestartet!");
		try {
			lines = Files.readAllLines(Paths.get(
					"C:\\Users\\Sandro\\Nextcloud\\Studium\\6_Semester\\VS\\workspace\\uebung03_02\\src\\uebung03_02\\index.html"));
		} catch (IOException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}

		while (true) {

			try {

				InputStream in = clientConnection.getInputStream();
				OutputStream out = clientConnection.getOutputStream();

				BufferedReader reader = new BufferedReader(new InputStreamReader(in));
				PrintWriter writer = new PrintWriter(out);

				writer.println("HTTP/1.1 200 ok\r\n");
				writer.println("Content-Type: text\\html\r\n");
				writer.println("Content-Length: 10\r\n");
				for (String line : lines) {
					System.out.println(line);
					writer.println(line);
				}

			} catch (IOException e) {
				e.printStackTrace();
			}
		}

	}

}
